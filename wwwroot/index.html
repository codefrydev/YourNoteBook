<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Note Book</title>
    <base href="/" /> 
    <link rel="icon" type="image/png" href="favicon.png" />
    
    <!-- Tailwind CSS CDN (Development only - replace with local build for production) -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Tailwind Configuration -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#eff6ff',
                            100: '#dbeafe',
                            200: '#bfdbfe',
                            300: '#93c5fd',
                            400: '#60a5fa',
                            500: '#3b82f6',
                            600: '#2563eb',
                            700: '#1d4ed8',
                            800: '#1e40af',
                            900: '#1e3a8a',
                            950: '#172554',
                        },
                        secondary: {
                            50: '#f8fafc',
                            100: '#f1f5f9',
                            200: '#e2e8f0',
                            300: '#cbd5e1',
                            400: '#94a3b8',
                            500: '#64748b',
                            600: '#475569',
                            700: '#334155',
                            800: '#1e293b',
                            900: '#0f172a',
                            950: '#020617',
                        },
                        accent: {
                            50: '#fdf4ff',
                            100: '#fae8ff',
                            200: '#f5d0fe',
                            300: '#f0abfc',
                            400: '#e879f9',
                            500: '#d946ef',
                            600: '#c026d3',
                            700: '#a21caf',
                            800: '#86198f',
                            900: '#701a75',
                            950: '#4a044e',
                        },
                        success: {
                            50: '#f0fdf4',
                            100: '#dcfce7',
                            200: '#bbf7d0',
                            300: '#86efac',
                            400: '#4ade80',
                            500: '#22c55e',
                            600: '#16a34a',
                            700: '#15803d',
                            800: '#166534',
                            900: '#14532d',
                            950: '#052e16',
                        },
                        warning: {
                            50: '#fffbeb',
                            100: '#fef3c7',
                            200: '#fde68a',
                            300: '#fcd34d',
                            400: '#fbbf24',
                            500: '#f59e0b',
                            600: '#d97706',
                            700: '#b45309',
                            800: '#92400e',
                            900: '#78350f',
                            950: '#451a03',
                        },
                        error: {
                            50: '#fef2f2',
                            100: '#fee2e2',
                            200: '#fecaca',
                            300: '#fca5a5',
                            400: '#f87171',
                            500: '#ef4444',
                            600: '#dc2626',
                            700: '#b91c1c',
                            800: '#991b1b',
                            900: '#7f1d1d',
                            950: '#450a0a',
                        }
                    },
                    fontFamily: {
                        'sans': ['Inter', 'ui-sans-serif', 'system-ui', '-apple-system', 'BlinkMacSystemFont', 'Segoe UI', 'Roboto', 'Helvetica Neue', 'Arial', 'Noto Sans', 'sans-serif'],
                        'serif': ['ui-serif', 'Georgia', 'Cambria', 'Times New Roman', 'Times', 'serif'],
                        'mono': ['ui-monospace', 'SFMono-Regular', 'Menlo', 'Monaco', 'Consolas', 'Liberation Mono', 'Courier New', 'monospace'],
                    },
                    spacing: {
                        '18': '4.5rem',
                        '88': '22rem',
                        '128': '32rem',
                    },
                    borderRadius: {
                        '4xl': '2rem',
                    },
                    boxShadow: {
                        'soft': '0 2px 15px -3px rgba(0, 0, 0, 0.07), 0 10px 20px -2px rgba(0, 0, 0, 0.04)',
                        'medium': '0 4px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)',
                        'large': '0 10px 40px -10px rgba(0, 0, 0, 0.1), 0 2px 10px -2px rgba(0, 0, 0, 0.04)',
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-in-out',
                        'slide-up': 'slideUp 0.3s ease-out',
                        'slide-down': 'slideDown 0.3s ease-out',
                        'scale-in': 'scaleIn 0.2s ease-out',
                        'bounce-gentle': 'bounceGentle 2s infinite',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        },
                        slideUp: {
                            '0%': { transform: 'translateY(10px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' },
                        },
                        slideDown: {
                            '0%': { transform: 'translateY(-10px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' },
                        },
                        scaleIn: {
                            '0%': { transform: 'scale(0.95)', opacity: '0' },
                            '100%': { transform: 'scale(1)', opacity: '1' },
                        },
                        bounceGentle: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-5px)' },
                        },
                    },
                }
            },
            darkMode: 'class',
            plugins: [
                function({ addUtilities }) {
                    addUtilities({
                        '.glass': {
                            'background': 'rgba(255, 255, 255, 0.1)',
                            'backdrop-filter': 'blur(10px)',
                            'border': '1px solid rgba(255, 255, 255, 0.2)',
                        },
                        '.glass-dark': {
                            'background': 'rgba(0, 0, 0, 0.1)',
                            'backdrop-filter': 'blur(10px)',
                            'border': '1px solid rgba(255, 255, 255, 0.1)',
                        },
                        '.text-gradient': {
                            'background': 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                            '-webkit-background-clip': 'text',
                            '-webkit-text-fill-color': 'transparent',
                            'background-clip': 'text',
                        },
                        '.btn-primary': {
                            'background': 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                            'color': 'white',
                            'padding': '0.75rem 1.5rem',
                            'border-radius': '0.5rem',
                            'font-weight': '600',
                            'transition': 'all 0.3s ease',
                            'border': 'none',
                            'cursor': 'pointer',
                        },
                        '.btn-primary:hover': {
                            'transform': 'translateY(-2px)',
                            'box-shadow': '0 10px 25px -5px rgba(0, 0, 0, 0.2)',
                        },
                        '.card': {
                            'background': 'white',
                            'border-radius': '1rem',
                            'box-shadow': '0 4px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)',
                            'transition': 'all 0.3s ease',
                        },
                        '.card:hover': {
                            'transform': 'translateY(-4px)',
                            'box-shadow': '0 10px 40px -10px rgba(0, 0, 0, 0.1), 0 2px 10px -2px rgba(0, 0, 0, 0.04)',
                        },
                        '.card-dark': {
                            'background': '#1e293b',
                            'border-radius': '1rem',
                            'box-shadow': '0 4px 25px -5px rgba(0, 0, 0, 0.3), 0 10px 10px -5px rgba(0, 0, 0, 0.1)',
                            'transition': 'all 0.3s ease',
                        },
                        '.card-dark:hover': {
                            'transform': 'translateY(-4px)',
                            'box-shadow': '0 10px 40px -10px rgba(0, 0, 0, 0.4), 0 2px 10px -2px rgba(0, 0, 0, 0.1)',
                        },
                    })
                }
            ]
        }
    </script>
    
    <!-- Google Fonts with fallback -->
    <link rel="preconnect" href="https://fonts.googleapis.com" onerror="console.log('Google Fonts connection failed, using fallback fonts')">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin onerror="console.log('Google Fonts static connection failed')">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet" onerror="console.log('Inter font failed to load, using system fonts')">
    
    <!-- Font Awesome with fallback -->
    <link href="https://use.fontawesome.com/releases/v5.14.0/css/all.css" rel="stylesheet" onerror="console.log('Font Awesome failed to load, using fallback icons')">
    
    <!-- Highlight.js with fallback -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.0/styles/default.min.css" onerror="console.log('Highlight.js CSS failed to load')">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.0/highlight.min.js" onerror="console.log('Highlight.js JS failed to load')"></script>
    
    <!-- Material Icons with fallback -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" onerror="console.log('Material Icons failed to load, using fallback icons')">
    
    <!-- Custom Styles -->
    <script src="highlight.js"></script>
    <link rel="stylesheet" href="global.css">
    <link rel="stylesheet" href="modern-styles.css">
    
    <style>
        /* App Loading Screen Styles */
        .app-loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            overflow: hidden;
        }

        .dark .app-loading-screen {
            background: linear-gradient(135deg, #1f2937 0%, #111827 100%);
        }

        .app-loading-content {
            text-align: center;
            z-index: 10;
            position: relative;
        }

        .app-loading-logo {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 2rem;
        }

        .app-logo-icon {
            width: 4rem;
            height: 4rem;
            color: white;
            margin-bottom: 1rem;
            animation: appLogoFloat 3s ease-in-out infinite;
        }

        .app-logo-text {
            font-size: 1.5rem;
            font-weight: 700;
            color: white;
            letter-spacing: 0.05em;
        }

        .app-loading-animation {
            margin-bottom: 2rem;
        }

        .app-loading-dots {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
        }

        .app-dot {
            width: 0.75rem;
            height: 0.75rem;
            background-color: white;
            border-radius: 50%;
            animation: appDotBounce 1.4s ease-in-out infinite both;
        }

        .app-dot:nth-child(1) { animation-delay: -0.32s; }
        .app-dot:nth-child(2) { animation-delay: -0.16s; }
        .app-dot:nth-child(3) { animation-delay: 0s; }

        .app-loading-text {
            margin-bottom: 2rem;
        }

        .app-loading-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: white;
            margin-bottom: 0.5rem;
            opacity: 0.9;
        }

        .app-loading-subtitle {
            font-size: 0.875rem;
            color: white;
            opacity: 0.7;
            margin: 0;
        }

        .app-loading-tips {
            margin-top: 2rem;
        }

        .app-tip-item {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.75rem 1rem;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 0.5rem;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .app-tip-icon {
            font-size: 1rem;
        }

        .app-tip-text {
            font-size: 0.875rem;
            color: white;
            opacity: 0.9;
        }

        .app-loading-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }

        .app-bg-circle {
            position: absolute;
            border-radius: 50%;
            background: linear-gradient(45deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
            animation: appFloat 6s ease-in-out infinite;
        }

        .app-circle-1 {
            width: 20rem;
            height: 20rem;
            top: -10rem;
            left: -10rem;
            animation-delay: 0s;
        }

        .app-circle-2 {
            width: 15rem;
            height: 15rem;
            bottom: -7.5rem;
            right: -7.5rem;
            animation-delay: 2s;
        }

        .app-circle-3 {
            width: 10rem;
            height: 10rem;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            animation-delay: 4s;
        }

        /* Animations */
        @keyframes appLogoFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        @keyframes appDotBounce {
            0%, 80%, 100% { 
                transform: scale(0);
                opacity: 0.5;
            }
            40% { 
                transform: scale(1);
                opacity: 1;
            }
        }

        @keyframes appFloat {
            0%, 100% { 
                transform: translateY(0px) rotate(0deg);
                opacity: 0.7;
            }
            50% { 
                transform: translateY(-20px) rotate(180deg);
                opacity: 0.3;
            }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .app-logo-icon {
                width: 3rem;
                height: 3rem;
            }

            .app-logo-text {
                font-size: 1.25rem;
            }

            .app-loading-title {
                font-size: 1.125rem;
            }

            .app-circle-1 {
                width: 15rem;
                height: 15rem;
                top: -7.5rem;
                left: -7.5rem;
            }

            .app-circle-2 {
                width: 12rem;
                height: 12rem;
                bottom: -6rem;
                right: -6rem;
            }

            .app-circle-3 {
                width: 8rem;
                height: 8rem;
            }
        }
    </style>
</head>

<body>  

    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js" onerror="console.log('Firebase App failed to load, Firebase features will be disabled')"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js" onerror="console.log('Firebase Firestore failed to load, database features will be disabled')"></script>
     
    <div id="app" >
        <div class="app-loading-screen">
            <div class="app-loading-content">
                <!-- Modern Logo Animation -->
                <div class="app-loading-logo">
                    <div class="app-logo-icon">
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M3 7V5C3 3.89543 3.89543 3 5 3H9L11 5H19C20.1046 5 21 5.89543 21 7V17C21 18.1046 20.1046 19 19 19H5C3.89543 19 3 18.1046 3 17V7Z" 
                                  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M8 11H16M8 15H12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                    </div>
                    <div class="app-logo-text">YourNoteBook</div>
                </div>

                <!-- Modern Loading Animation -->
                <div class="app-loading-animation">
                    <div class="app-loading-dots">
                        <div class="app-dot"></div>
                        <div class="app-dot"></div>
                        <div class="app-dot"></div>
                    </div>
                </div>

                <!-- Loading Text -->
                <div class="app-loading-text">
                    <h2 class="app-loading-title">Loading Your Notebook</h2>
                    <p class="app-loading-subtitle">Preparing your digital workspace...</p>
                </div>

                <!-- Loading Tips -->
                <div class="app-loading-tips">
                    <div class="app-tip-item">
                        <span class="app-tip-icon">💡</span>
                        <span class="app-tip-text" id="loading-tip">Organize your notes with folders for better structure</span>
                    </div>
                </div>
            </div>

            <!-- Background Animation -->
            <div class="app-loading-background">
                <div class="app-bg-circle app-circle-1"></div>
                <div class="app-bg-circle app-circle-2"></div>
                <div class="app-bg-circle app-circle-3"></div>
            </div>
        </div>
            </div>
        </div>
    </div>
    
    <div id="blazor-error-ui" class="fixed bottom-0 left-0 right-0 z-50 bg-red-500 text-white p-4 hidden">
        <div class="flex items-center justify-between max-w-4xl mx-auto">
            <div class="flex items-center space-x-2">
                <i class="fas fa-exclamation-triangle"></i>
                <span>An unhandled error has occurred.</span>
            </div>
            <div class="flex items-center space-x-4">
                <a href="." class="text-white hover:text-gray-200 underline font-medium">Reload</a>
                <button class="text-white hover:text-gray-200 text-xl font-bold" onclick="this.parentElement.parentElement.parentElement.style.display='none'">×</button>
            </div>
        </div>
    </div>
    <script src="firebaseInterop.js"></script> 
    <script src="_content/Blazored.LocalStorage/Blazored.LocalStorage.js" onerror="console.log('Blazored.LocalStorage.js not found, continuing without it')"></script>
    
    <script>
        // Handle missing resources gracefully
        window.addEventListener('error', function(e) {
            if (e.target.tagName === 'LINK' || e.target.tagName === 'SCRIPT') {
                console.log(`Resource failed to load: ${e.target.src || e.target.href}`);
                // Don't prevent default behavior, just log the error
            }
        });

        // Options dialog function
        window.showOptions = (title, options) => {
            return new Promise((resolve) => {
                const choice = prompt(`${title}\n\nOptions:\n${options.map((opt, i) => `${i + 1}. ${opt}`).join('\n')}\n\nEnter number (1-${options.length}):`);
                const index = parseInt(choice) - 1;
                if (index >= 0 && index < options.length) {
                    resolve(options[index]);
                } else {
                    resolve(null);
                }
            });
        };

        // Check if Firebase is available
        window.isFirebaseAvailable = () => {
            return typeof firebase !== 'undefined' && firebase.apps && firebase.apps.length > 0;
        };

        // Masonry Layout Enhancement
        function initMasonry() {
            const masonryContainer = document.querySelector('.masonry-container');
            if (!masonryContainer) return;

            // Add smooth transitions for masonry items
            const items = masonryContainer.querySelectorAll('.masonry-item');
            items.forEach((item, index) => {
                item.style.opacity = '0';
                item.style.transform = 'translateY(20px)';
                
                setTimeout(() => {
                    item.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
                    item.style.opacity = '1';
                    item.style.transform = 'translateY(0)';
                }, index * 50);
            });
        }

        // Initialize masonry when DOM is loaded
        document.addEventListener('DOMContentLoaded', initMasonry);

        // Re-initialize masonry when Blazor components are updated
        window.addEventListener('load', initMasonry);

        // Loading tips rotation
        const tips = [
            "Organize your notes with folders for better structure",
            "Use tags to categorize and find your content quickly",
            "Create shortcuts for frequently accessed items",
            "Sync your data across devices with Firebase",
            "Use the search feature to find any note instantly",
            "Dark mode is available for comfortable reading",
            "Export your notes in various formats",
            "Backup your data regularly for safety"
        ];
        
        let currentTipIndex = 0;
        const tipElement = document.getElementById('loading-tip');
        
        function rotateTip() {
            if (tipElement) {
                tipElement.style.opacity = '0';
                setTimeout(() => {
                    tipElement.textContent = tips[currentTipIndex];
                    tipElement.style.opacity = '0.9';
                    currentTipIndex = (currentTipIndex + 1) % tips.length;
                }, 300);
            }
        }
        
        // Start tip rotation after a delay
        setTimeout(() => {
            setInterval(rotateTip, 3000);
        }, 2000);
    </script>
    
    <script src="_framework/blazor.webassembly.js"></script>
</body>

</html>